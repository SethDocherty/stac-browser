const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Description--FRGVWTh.js","assets/_commonjsHelpers-CE1G-McA.js","assets/index-B3B6zu_i.js","assets/utils-UTZ1_q7B.js","assets/I18N-DlIXJTel.js","assets/index-tJa7Rfc7.css","assets/Description-BJNSZaWm.css"])))=>i.map(i=>d[i]);
import{a4 as C,n,B as c,y,bk as E,bl as b,H as m,G as l,L as f,q as p,I as L,ax as T,p as o,v as _,K as d,_ as B,bt as F,bu as j}from"./index-B3B6zu_i.js";import{a as A}from"./BFormCheckboxGroup.vue_vue_type_script_setup_true_lang-Dx_mpGFE-QCUzAbd_.js";import{_ as N}from"./BFormInput.vue_vue_type_script_setup_true_lang-DRDhfD8d-D-GW5NTI.js";import{b as S}from"./BFormSelect.vue_vue_type_script_setup_true_lang-djrVhugk-CxKovKCC.js";import{_ as P}from"./BBadge.vue_vue_type_script_setup_true_lang-D9DEOOtU-B8B6oeuQ.js";import{b as W,_ as M}from"./BDropdownText.vue_vue_type_script_setup_true_lang-Cm6QYE9x-jjyo8fuu.js";import{C as I,D as U}from"./SearchFilter-CFXUVPZs.js";import{j as z}from"./utils-UTZ1_q7B.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DaMHx4U3-ChgfDD4K.js";import"./useStateClass-BGbSLWFN-SUahktxd.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--DPhN8Txe.js";import"./debounce-BHqBzJ1a-5KgoXsWq.js";import"./BForm.vue_vue_type_script_setup_true_lang-u44ElAm9-CMSgr5dy.js";import"./BFormGroup.vue_vue_type_script_setup_true_lang-RIWLdYTY-C5ZMQmeL.js";import"./BCard.vue_vue_type_script_setup_true_lang-9RhyvL8I-DZc8xwAU.js";import"./startOfWeek-m7vVpAR3.js";import"./en-US-DRXoBfJp.js";import"./match-DN4VZKeM.js";import"./buildMatchPatternFn-_eSDZv-o.js";import"./Loading-Dmqb7s3M.js";import"./helper-CaHhXSPV.js";import"./helper-DO3U350M.js";const Q={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function R(e,t){return n(),c("svg",Q,[...t[0]||(t[0]=[y("path",{fill:"currentColor",d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"},null,-1)])])}const G=C({name:"bi-x-circle-fill",render:R}),H={data(){return{rawInput:"",validationErrors:[],validationWarnings:[]}},computed:{placeholder(){return this.$t("search.arrayInput.helpText")},validationState(){const e=this.value?.value||[];return this.validationErrors.length>0?!1:e&&e.length>0?!0:null},validationFeedback(){if(this.validationErrors.length===0)return"";const e=3;let a=this.validationErrors.slice(0,e).join("; ");return this.validationErrors.length>e&&(a+=this.$t("search.arrayInput.andMoreErrors",{count:this.validationErrors.length-e})),a},warningFeedback(){if(this.validationWarnings.length===0)return"";const e=3;let a=this.validationWarnings.slice(0,e).join("; ");return this.validationWarnings.length>e&&(a+=this.$t("search.arrayInput.andMoreWarnings",{count:this.validationWarnings.length-e})),a}},watch:{rawInput(e){if(!this.queryable?.isArray)return;const t=this.parseInput(e);this.validate(t),this.$emit("update:value",I.create(t))},value:{handler(e){if(!this.queryable?.isArray)return;const t=e?.value||[],a=t.length>0?t.join(", "):"";this.rawInput!==a&&(this.rawInput=a)},deep:!0}},created(){if(!this.queryable?.isArray)return;const e=this.value?.value||[];this.validate(e),e.length>0&&(this.rawInput=e.join(", "))},methods:{parseInput(e){if(!e||e.trim()==="")return[];const t=this.queryable?.schema?.items?.type;return e.split(",").map(a=>a.trim()).filter(a=>a!=="").map(a=>{if(t==="integer"){const s=parseInt(a,10);return!Number.isNaN(s)&&String(s)===a?s:a}if(t==="number"){const s=parseFloat(a);return Number.isFinite(s)?s:a}if(t==="boolean"){const s=a.toLowerCase();return s==="true"?!0:s==="false"?!1:a}return a})},validate(e){const t=[],a=[];(!e||e.length===0)&&t.push(this.$t("search.arrayInput.required"));const s=new Set,v=[];e.forEach(u=>{s.has(u)?v.push(u):s.add(u)});const r=[...new Set(v)];if(r.length>0){let h=r.slice(0,5).map(g=>this.truncate(g)).join(", ");r.length>5&&(h+=", ..."),a.push(this.$t("search.arrayInput.duplicates",{values:h}))}this.validationErrors=t,this.validationWarnings=a},truncate(e,t=20){return e.length<=t?e:e.substring(0,t)+"..."}}},K={name:"QueryableInput",components:{BDropdown:M,BDropdownItemButton:W,Description:F(()=>j(()=>import("./Description--FRGVWTh.js"),__vite__mapDeps([0,1,2,3,4,5,6])))},mixins:[U,H],props:{value:{},operator:{type:Function,required:!0},queryable:{type:Object,required:!0},cql:{type:Object,required:!0}},emits:["remove-queryable","update:value","update:operator"],computed:{validation(){return this.queryable.isText?{type:"text",minlength:this.schema.minLength,maxlength:this.schema.maxLength,required:this.schema.minLength>0}:this.queryable.isNumeric?{type:"number",number:!0,min:this.schema.minimum,max:this.schema.maximum,step:this.schema.multipleOf||"any"}:{}},schema(){return this.queryable.schema},operators(){return this.queryable.getOperators(this.cql)},queryableOptions(){return this.queryable.isSelection?this.schema.enum.map(e=>({value:e,text:e})):[]}},methods:{iterateOps(){let e=this.operators.findIndex(a=>a===this.operator),t=++e%this.operators.length;this.updateOperator(this.operators[t])},updateValue(e){let t=z.isObject(e)&&"target"in e?e.target.value:e;typeof t=="string"&&this.queryable.is("integer")?t=parseInt(t,10):typeof t=="string"&&this.queryable.is("number")&&(t=parseFloat(t)),this.$emit("update:value",I.create(t))},updateOperator(e){this.$emit("update:operator",e)}}},Y={class:"queryable-group"},J={class:"queryable-row"},X={class:"title"},Z={key:0,class:"queryable-help text-muted small"},$={key:1,class:"queryable-help text-danger small"},ee={key:2,class:"queryable-help text-warning small"};function te(e,t,a,s,v,r){const u=P,q=b("b-dropdown-item-button"),h=b("b-dropdown"),g=b("VueDatePicker"),x=S,w=N,V=A,D=G,O=B,k=b("Description");return n(),c("div",Y,[y("div",J,[y("span",X,m(a.queryable.title),1),t[6]||(t[6]=l()),f(h,{size:"sm",class:"op",variant:"dark",split:"",text:a.operator.label,onClick:r.iterateOps},{default:p(()=>[(n(!0),c(L,null,T(r.operators,i=>(n(),o(q,{key:i.SYMBOL,active:i===a.operator,onClick:ae=>r.updateOperator(i),"button-class":"d-flex justify-content-between align-items-center"},{default:p(()=>[y("span",null,m(i.longLabel),1),t[5]||(t[5]=l()),f(u,{variant:"dark",class:"ms-2"},{default:p(()=>[l(m(i.label),1)]),_:2},1024)]),_:2},1032,["active","onClick"]))),128))]),_:1},8,["text","onClick"]),t[7]||(t[7]=l()),a.queryable.isTemporal?(n(),o(g,{key:0,class:"value","model-value":a.value?.value,"onUpdate:modelValue":r.updateValue,locale:e.datepickerLang,"week-start":e.weekStartDay,formats:{input:a.queryable.isDateTime?e.dateTimeFormat:e.dateFormat},"close-on-scroll":!1,"time-config":{enableTimePicker:a.queryable.isDateTime,seconds:a.queryable.isDateTime,timePickerInline:!0},"input-attrs":{clearable:!0},"auto-apply":""},null,8,["model-value","onUpdate:modelValue","locale","week-start","formats","time-config"])):a.queryable.isSelection?(n(),o(x,_({key:1,options:r.queryableOptions,size:"sm",class:"value","model-value":a.value.value,"onUpdate:modelValue":t[0]||(t[0]=i=>r.updateValue(i))},r.validation),null,16,["options","model-value"])):a.queryable.isText||a.queryable.isNumeric?(n(),o(w,_({key:2,size:"sm",class:"value","model-value":a.value.value,"onUpdate:modelValue":t[1]||(t[1]=i=>r.updateValue(i))},r.validation),null,16,["model-value"])):a.queryable.isArray?(n(),o(w,{key:3,size:"sm",class:"value",modelValue:e.rawInput,"onUpdate:modelValue":t[2]||(t[2]=i=>e.rawInput=i),placeholder:e.placeholder,state:e.validationState},null,8,["modelValue","placeholder","state"])):a.queryable.isBoolean?(n(),o(V,_({key:4,switch:"",class:"value","model-value":a.value.value,"onUpdate:modelValue":t[3]||(t[3]=i=>r.updateValue(i))},r.validation),{default:p(()=>[l(m(e.$t(`checkbox.${a.value.value}`)),1)]),_:1},16,["model-value"])):d("",!0),t[8]||(t[8]=l()),f(O,{class:"delete",size:"sm",variant:"danger",onClick:t[4]||(t[4]=i=>e.$emit("remove-queryable"))},{default:p(()=>[f(D,{"aria-hidden":"true"})]),_:1})]),t[10]||(t[10]=l()),a.queryable.description||a.operator.description?(n(),c("div",Z,[a.operator.description?(n(),o(k,{key:0,description:a.operator.description,inline:""},null,8,["description"])):d("",!0),t[9]||(t[9]=l()),a.queryable.description?(n(),o(k,{key:1,description:a.queryable.description,inline:""},null,8,["description"])):d("",!0)])):d("",!0),t[11]||(t[11]=l()),a.queryable.isArray&&e.validationErrors.length>0?(n(),c("div",$,m(e.validationFeedback),1)):d("",!0),t[12]||(t[12]=l()),a.queryable.isArray&&e.validationWarnings.length>0?(n(),c("div",ee,m(e.warningFeedback),1)):d("",!0)])}const De=E(K,[["render",te]]);export{De as default};
//# sourceMappingURL=QueryableInput-Bz9KW2vr.js.map
