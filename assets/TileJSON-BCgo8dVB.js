import{y as a,an as h,q as d,_ as u}from"./GeoJSON-BPTypvZI.js";import{j as p}from"./net-COnnm0S_.js";import{e as S,c as f}from"./Tile-D1_54PHN.js";import{c as T}from"./tileurlfunction-Nqm9rVh9.js";import E from"./TileImage-CF3lpDFP.js";import"./index-DxkmsBdF.js";import"./utils-UTZ1_q7B.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DaMHx4U3-Bgrm5c_H.js";import"./useStateClass-BGbSLWFN-Dclm8Qkt.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--DrCiXEJF.js";import"./tilecoord-DP6aZtxC.js";import"./TileGrid-DCK0ZFkp.js";import"./TileRange-2Tc-Ry00.js";import"./uri-BOy4sXyk.js";import"./Tile-BFjpDrEF.js";import"./Tile-DTmvpdXf.js";import"./common-oM3VNg4d.js";import"./UrlTile-ppXIK2AL.js";import"./TileEventType-CTN_nmJ7.js";class D extends E{constructor(t){if(super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:a("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)p(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else if(t.tileJSON)this.handleTileJSONResponse(t.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let r;try{r=JSON.parse(e.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(r)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=a("EPSG:4326"),r=this.getProjection();let i;if(t.bounds!==void 0){const o=h(e,r);i=d(t.bounds,o)}const n=S(r),l=t.minzoom||0,m=t.maxzoom||22,s=f({extent:n,maxZoom:m,minZoom:l,tileSize:this.tileSize_});if(this.tileGrid=s,this.tileUrlFunction=T(t.tiles,s),t.attribution&&!this.getAttributions()){const o=i!==void 0?i:n;this.setAttributions(function(c){return u(o,c.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState("ready")}handleTileJSONError(){this.setState("error")}}export{D as default};
//# sourceMappingURL=TileJSON-BCgo8dVB.js.map
